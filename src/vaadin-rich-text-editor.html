<!--
@license
Copyright (c) 2018 Vaadin Ltd.
This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
-->

<link rel="import" href="../../polymer/polymer-element.html">
<link rel="import" href="../../vaadin-themable-mixin/vaadin-themable-mixin.html">
<link rel="import" href="../../vaadin-element-mixin/vaadin-element-mixin.html">
<link rel="import" href="../../vaadin-license-checker/vaadin-license-checker.html">

<link rel="import" href="./vaadin-quill.html">

<dom-module id="vaadin-rich-text-editor">
  <template>
    <style include="vaadin-quill-styles">
      :host {
        display: block;
      }

      :host([hidden]) {
        display: none !important;
      }

      [part="editor"] {
        min-height: 200px;
      }
    </style>

    <!-- Create toolbar container -->
    <div part="toolbar">

      <!--
        FIXME: all the dropdowns are broken
        - in Safari polyfilled selection does not apply
        - in Shady DOM the style scope does not apply
      -->

      <!--
      <select class="ql-size">
        <option value="small"></option>
        <option selected></option>
        <option value="large"></option>
        <option value="huge"></option>
      </select>

      <select class="ql-font">
        <option selected></option>
        <option value="serif"></option>
        <option value="monospace"></option>
      </select>
      -->

      <!-- Bold -->
      <button class="ql-bold"></button>

      <!-- Italic -->
      <button class="ql-italic"></button>

      <!-- Underline -->
      <button class="ql-underline"></button>

      <!-- Strike -->
      <button class="ql-strike"></button>

      <!-- Subscript and superscript -->
      <button class="ql-script" value="sub"></button>
      <button class="ql-script" value="super"></button>

      <!-- Header buttons -->
      <button type="button" class="ql-header" value="1"></button>
      <button type="button" class="ql-header" value="2"></button>

      <!-- List buttons -->
      <button type="button" class="ql-list" value="bullet"></button>
      <button type="button" class="ql-list" value="ordered"></button>

      <!-- Indentation buttons -->
      <button type="button" class="ql-indent" value="-1"></button>
      <button type="button" class="ql-indent" value="+1"></button>

      <!-- Align buttons -->
      <button type="button" class="ql-align" value=""></button>
      <button type="button" class="ql-align" value="center"></button>
      <button type="button" class="ql-align" value="right"></button>
      <button type="button" class="ql-align" value="justify"></button>

      <!-- Blockquote -->
      <button type="button" class="ql-blockquote"></button>

      <!-- Code block -->
      <button type="button" class="ql-code-block"></button>

      <!-- Clean -->
      <button type="button" class="ql-clean"></button>
    </div>

    <div part="editor"></div>

  </template>

  <script>
    (function() {

      /**
       * `<vaadin-rich-text-editor>` is a Web Component for rich text editing.
       *
       * ```
       * <vaadin-rich-text-editor></vaadin-rich-text-editor>
       * ```
       *
       * @memberof Vaadin
       * @mixes Vaadin.ElementMixin
       * @mixes Vaadin.ThemableMixin
       * @demo demo/index.html
       */
      class RichTextEditorElement extends Vaadin.ElementMixin(Vaadin.ThemableMixin(Polymer.Element)) {
        static get is() {
          return 'vaadin-rich-text-editor';
        }
        static get version() {
          return '0.1.0';
        }

        static get properties() {
          return {
          };
        }

        ready() {
          super.ready();

          const editor = this.shadowRoot.querySelector('[part="editor"]');
          const toolbar = this.shadowRoot.querySelector('[part="toolbar"]');

          new window.Quill(editor, {
            modules: {
              toolbar: toolbar
            },
            placeholder: 'Type something...',
            theme: 'snow'
          });
        }
      }

      customElements.define(RichTextEditorElement.is, RichTextEditorElement);

      /**
       * @namespace Vaadin
       */
      window.Vaadin.RichTextEditorElement = RichTextEditorElement;

      const devModeCallback = window.Vaadin.developmentModeCallback;
      const licenseChecker = devModeCallback && devModeCallback['vaadin-license-checker'];
      if (typeof licenseChecker === 'function') {
        licenseChecker(RichTextEditorElement);
      }
    })();
  </script>
</dom-module>
